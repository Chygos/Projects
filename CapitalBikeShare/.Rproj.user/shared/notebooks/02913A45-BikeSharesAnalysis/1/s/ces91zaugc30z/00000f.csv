"0","    aggregate_data <- function(data, column, groups){"
"0","        select_cols = c(column, groups)"
"0","        print(select_cols)"
"0","        df <- data[,select_cols] |>"
"0","                group_by(across(all_of(groups))) |>"
"0","                summarize(val = sum(.data[[column]])) |>"
"0","                mutate(perc = val/sum(val))"
"0","        return(df)"
"0","    }"
