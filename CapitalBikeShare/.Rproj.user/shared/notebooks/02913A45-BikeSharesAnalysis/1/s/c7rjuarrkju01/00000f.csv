"0","plot_frequency <- function(data, colname=NULL, title=NULL){"
"0","    df <- data |>"
"0","    group_by(.data[[colname]]) |>"
"0","    count() |>"
"0","    ungroup() |>"
"0","    mutate(perc = 100*n/sum(n))"
"0","    "
"0","    ggplot(data=df, aes(x=.data[[colname]], y=n)) +"
"0","    "
"0","    geom_col(fill='steelblue') +"
"0","    geom_text(aes(x=.data[[colname]], y=n, label=paste0(round(perc,2),'%')), "
"0","              vjust=1.4, fontface='bold', color='white') +"
"0","    theme_tufte() +"
"0","    theme(plot.title=element_text(hjust=-.5)) +"
"0","    labs(title=title, x=colname, y='Frequency') +"
"0","    scale_y_continuous(breaks=seq(0,44000,7500), "
"0","                       labels=scales::label_number(scale=1e-3, suffix='K'))"
"0","}"
"0",""
"0",""
"0","plot_distribution <- function(data, colname=NULL, fill=NULL, title=NULL){"
"0","    if (is.null(fill)) {"
"0","        box <- ggboxplot(data, y=colname, width=0.4, fill='steelblue', title=title) + "
"0","        theme_tufte() +"
"0","        theme(plot.title=element_text(face='bold'))"
"0","        "
"0","        hist_ <- gghistogram(data, x=colname, fill='steelblue', bins=40) + "
"0","        theme_tufte() +"
"0","        theme(plot.title=element_text(face='bold'))"
"0","        "
"0","        ggarrange(box, hist_, ncol=2) "
"0","    } else{"
"0","        box <- ggboxplot(data, x=fill, y=colname, width=0.4, fill=fill, title=title) + "
"0","        theme_tufte() +"
"0","        theme(plot.title=element_text(face='bold'))"
"0","        "
"0","        hist_ <- gghistogram(data, x=colname, fill=fill, alpha=0.6, bins=40) + "
"0","        theme_tufte() +"
"0","        theme(plot.title=element_text(face='bold'))"
"0","        "
"0","        ggarrange(box, hist_, ncol=2, common.legend=T, legend='right')"
"0","    }"
"0","}"
